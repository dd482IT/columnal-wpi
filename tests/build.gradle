apply plugin: 'java-library'
apply plugin: 'org.checkerframework'
apply plugin: 'org.openjfx.javafxplugin'

dependencies {
    implementation project(':app')
    implementation project(':data')
    implementation project(':expressions')
    implementation project(':functions')
    implementation project(':gui-utility')
    implementation project(':lex-editor')
    implementation project(':parsers')
    implementation project(':r-interop')
    implementation project(':stf')
    implementation project(':transformations')
    implementation project(':utility')
    testImplementation libs.hamcrest
    implementation libs.commons.io
    implementation 'org.apache.poi:poi-ooxml:4.1.2'
    implementation libs.guava
    implementation 'one.util:streamex:0.8.1'
    implementation libs.javaSMT
    implementation libs.commons.lang3
    implementation libs.controlsfx
    testImplementation libs.bundles.junitWithQuickcheck
    testImplementation 'org.testfx:testfx-core:4.0.16-alpha'
    testImplementation 'org.testfx:testfx-junit:4.0.15-alpha'
    testImplementation 'org.testfx:openjfx-monocle:jdk-12.0.1+2'
    testAnnotationProcessor project(':anns')
    testAnnotationProcessor project(':anns-threadchecker')
    testAnnotationProcessor project(':threadchecker')
    testCompileOnly project(':anns')
    testCompileOnly project(':anns-threadchecker')
    testCompileOnly project(':threadchecker')
}

javafx {
    modules = [ 'javafx.base', 'javafx.controls', 'javafx.swing' ]
    configuration = "testImplementation"
}

test {
    useJUnit()

    scanForTestClasses = false
    filter {
        includeTestsMatching "Test*"
        includeTestsMatching "Prop*"
        excludeTestsMatching "*\$*"
        excludeTestsMatching "test.TestUtil*"
    }
    
    //forkEvery = 1
    //maxParallelForks = 4 
    
    jvmArgs += ['-Xmx2G',
            '-Djava.awt.headless=true',
            '-Dtestfx.robot=glass', 
            '-Dtestfx.headless=true',
            '-Dprism.order=sw', 
            '-Dprism.text=t2k', 
            '-Dglass.platform=Monocle', 
            '-Dmonocle.platform=Headless', 
            '-Dheadless.geometry=1920x1200-32']
}

description = 'tests'
